# @package _global_

# Test configuration for descent metrics visualization
# Based on exp7_6 but optimized for quick testing

defaults:
  - override /data: salmon
  - override /model: exp7_6_model_digital
  - override /callbacks: default
  - override /trainer: default

tags: ["test", "descent_metrics", "visualization"]

seed: 1234

trainer:
  min_epochs: 1
  max_epochs: 1  # Just 1 epoch for testing
  gradient_clip_val: 0.5

model:
  compile: false
  epoch: 1
  
  # Enhanced probe configuration with descent metrics
  probe:
    enabled: true
    epochs: [1]  # Just epoch 1
    batches_per_epoch: 5  # Enough batches for statistics
    batch_size: 32
    alpha_eval: [0.0, 0.2, 0.5, 1.0, 2.0]
    seed: 1234
    
    # Task-centric descent metrics
    use_fp32_metrics: true  # Enable FP32 for comparison
    include_fb: false  # Exclude FB branches
    compute_descent_metrics: true  # Enable descent computations
    L_smooth: 1.0  # Smoothness constant for Descent Lemma
    
    # Output options
    create_summary: true
    create_plots: true
    alpha_crit_mode: 'S_perp_D'  # Standard critical alpha mode

data:
  batch_size: 128

logger:
  wandb:
    tags: ${tags}
    group: "descent-metrics-test"
  aim:
    experiment: "descent_test"